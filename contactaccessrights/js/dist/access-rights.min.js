define("access-rights/apis/rights.api",[],function(){"use strict";function e(e,s,t){var i={contact_id:t.search().cid};return e.extend({getLocations:function(){return this.sendGET("Rights","getlocations",i,!1)},getRegions:function(){return this.sendGET("Rights","getregions",i,!1)},deleteByIds:function(e){return s.all(e.map(function(e){return this.sendPOST("Rights","delete",{contact_id:t.search().cid,id:e})}.bind(this)))},saveRegions:function(e){return s.all(e.map(function(e){return this.sendPOST("Rights","create",{contact_id:t.search().cid,entity_id:e,entity_type:"hrjc_region"})}.bind(this)))},saveLocations:function(e){return s.all(e.map(function(e){return this.sendPOST("Rights","create",{contact_id:t.search().cid,entity_id:e,entity_type:"hrjc_location"})}.bind(this)))}})}return e.__name="RightsAPI",e.$inject=["api","$q","$location"],e}),define("access-rights/modules/access-rights.apis",["common/angular","common/services/api","access-rights/apis/rights.api"],function(e,s,t){"use strict";return e.module("access-rights.apis",["common.apis"]).factory(t.__name,t)}),define("access-rights/modules/access-rights.config",["common/angular"],function(e){"use strict";function s(e,s){e.html5Mode({enabled:!0,requireBase:!1}),s.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}e.module("access-rights.config",[]).config(s),s.$inject=["$locationProvider","$httpProvider"]}),define("access-rights/controllers/access-rights.controller",[],function(){"use strict";function e(e,s){function t(){s.open({appendTo:e.children().eq(0),controller:"AccessRightsModalController",controllerAs:"modalCtrl",bindToController:!0,templateUrl:CRM.vars.contactAccessRights.baseURL+"/views/access-rights-modal.html"})}this.openModal=t}return e.__name="AccessRightsController",e.$inject=["$rootElement","$uibModal"],e}),define("access-rights/controllers/access-rights-modal.controller",["common/lodash"],function(e){"use strict";function s(s,t,i,n,c){function o(){t.dismiss("cancel")}function r(t){var i=l.originalData[t],n=l.selectedData[t],o=i.map(function(e){return e.entity_id}),r=e.difference(n,o),a=e.difference(o,n).map(function(s){return e.find(i,function(e){return e.entity_id===s}).id}),u=[];return r.length>0&&u.push(c["save"+e.capitalize(t)](r)),a.length>0&&u.push(c.deleteByIds(a)),s.all(u)}function a(){l.submitting=!0,s.all([r("regions"),r("locations")]).then(function(){t.dismiss("cancel")}).catch(function(){l.errorMsg="Error while saving data"}).finally(function(){l.submitting=!0})}var l=this;l.dataLoaded=!1,l.errorMsg="",l.submitting=!1,l.availableData={regions:[],locations:[]},l.originalData={locations:[],regions:[]},l.selectedData={locations:[],regions:[]},l.cancel=o,l.submit=a,function(){s.all([i.getAll(),n.getAll()]).then(function(e){return{regions:e[0],locations:e[1]}}).then(function(t){return s.all(e.map(t,function(s,t){return l.availableData[t]=s,c["get"+e.capitalize(t)]()}))}).then(function(e){return{regions:e[0],locations:e[1]}}).then(function(e){Object.keys(e).forEach(function(s){l.originalData[s]=e[s].values,l.selectedData[s]=e[s].values.map(function(e){return e.entity_id})})}).then(function(){l.dataLoaded=!0})}()}return s.__name="AccessRightsModalController",s.$inject=["$q","$uibModalInstance","Region","Location","Right"],s}),define("access-rights/modules/access-rights.controllers",["common/angular","access-rights/controllers/access-rights.controller","access-rights/controllers/access-rights-modal.controller"],function(e,s,t){"use strict";return e.module("access-rights.controllers",[]).controller(s.__name,s).controller(t.__name,t)}),define("access-rights/modules/access-rights.core",["common/angular","common/ui-select","common/angularBootstrap","common/modules/xeditable-civi","common/directives/loading"],function(e){"use strict";e.module("access-rights.core",["ngAnimate","ui.bootstrap","ui.select","xeditable-civi","common.directives"])}),define("access-rights/models/location.model",["common/services/api/option-group"],function(){"use strict";function e(e,s){return e.extend({getAll:function(){return s.valuesOf("hrjc_location")}})}return e.__name="Location",e.$inject=["Model","api.optionGroup"],e}),define("access-rights/models/region.model",["common/services/api/option-group"],function(){"use strict";function e(e,s){return e.extend({getAll:function(){return s.valuesOf("hrjc_region")}})}return e.__name="Region",e.$inject=["Model","api.optionGroup"],e}),define("access-rights/models/right.model",[],function(){"use strict";function e(e,s){return e.extend({getLocations:s.getLocations.bind(s),getRegions:s.getRegions.bind(s),deleteByIds:s.deleteByIds.bind(s),saveRegions:s.saveRegions.bind(s),saveLocations:s.saveLocations.bind(s)})}return e.__name="Right",e.$inject=["Model","RightsAPI"],e}),define("access-rights/modules/access-rights.models",["common/angular","access-rights/models/location.model","access-rights/models/region.model","access-rights/models/right.model","common/models/model","access-rights/modules/access-rights.apis"],function(e,s,t,i){"use strict";return e.module("access-rights.models",["common.models","access-rights.apis"]).factory(s.__name,s).factory(t.__name,t).factory(i.__name,i)}),define("access-rights/modules/access-rights.run",["common/angular"],function(e){"use strict";function s(e,s,t){e.debug("app.run"),s.theme="bs3"}e.module("access-rights.run",[]).run(s),s.$inject=["$log","editableOptions","editableThemes"]}),define("access-rights/modules/access-rights.module",["common/angular","access-rights/modules/access-rights.apis","access-rights/modules/access-rights.config","access-rights/modules/access-rights.controllers","access-rights/modules/access-rights.core","access-rights/modules/access-rights.models","access-rights/modules/access-rights.run"],function(e){"use strict";return e.module("access-rights",["access-rights.core","access-rights.config","access-rights.run","access-rights.apis","access-rights.controllers","access-rights.models"]),e}),define("dom-initialization",["common/angular"],function(e){"use strict";return{addAppToDOM:function(){var s=e.element(".crm-actions-ribbon ul#actions"),t=e.element('<li id="access-rights"> <div ng-controller="AccessRightsController as accessRights" id="bootstrap-theme"> <a href class="edit button pull-right" ng-click="accessRights.openModal()" id="manage-roles-and-teams"> <div class="crm-i fa-edit"></div> Manage roles and teams </a> </div> </li>');return s.append(t),t}}}),function(){"use strict";var e=CRM.vars.contactAccessRights.baseURL+"/js/src/access-rights";require.config({urlArgs:"bust="+(new Date).getTime(),paths:{"access-rights":e}}),require(["access-rights/modules/access-rights.module","dom-initialization"],function(e,s){e.bootstrap(s.addAppToDOM(),["access-rights"])})}(require);
//# sourceMappingURL=/sites/all/modules/civicrm/tools/extensions/civihr/contactaccessrights/js/dist/access-rights.min.js.map